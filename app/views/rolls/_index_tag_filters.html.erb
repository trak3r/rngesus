<% if Tag.exists? %>
  <div class="border-b border-base-300 pb-6 mb-8">
    <div class="w-full">
      <!-- Desktop Filters -->
      <div class="hidden lg:flex flex-wrap gap-2 items-center">
        <span class="text-sm font-semibold mr-2 opacity-70 text-base-content">Filter by:</span>
        <% Tag.order(:name).each do |tag| %>
          <%= link_to tag.name,
              toggle_tag_url(tag.name, current_tags: @tags),
              class: "badge #{tag_active?(tag.name, current_tags: @tags) ? 'bg-base-content text-base-100 border-base-content' : 'bg-base-100 text-base-content border-base-content'} font-handwriting text-base hover:bg-base-content hover:text-base-100 transition-colors",
              data: { turbo_stream: true, turbo_action: "advance" } %>
        <% end %>
        <% if @tags.present? %>
          <%= link_to "Clear filters", rolls_path(tab: @tab, query: params[:query]),
              class: "text-error hover:text-error/70 font-handwriting text-base underline transition-colors ml-2",
              data: { turbo_stream: true, turbo_action: "advance" } %>
        <% end %>
      </div>

      <!-- Mobile Accordion -->
      <details class="lg:hidden collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
        <summary class="collapse-title text-lg font-medium font-handwriting">
          Filter by Tags <%= "(#{@tags.count})" if @tags.present? %>
        </summary>
        <div class="collapse-content">
          <div class="flex flex-wrap gap-2 pt-2">
            <% Tag.order(:name).each do |tag| %>
              <%= link_to tag.name,
                  toggle_tag_url(tag.name, current_tags: @tags),
                  class: "badge #{tag_active?(tag.name, current_tags: @tags) ? 'bg-base-content text-base-100 border-base-content' : 'bg-base-100 text-base-content border-base-content'} font-handwriting text-base hover:bg-base-content hover:text-base-100 transition-colors",
                  data: { turbo_stream: true, turbo_action: "advance" } %>
            <% end %>
            <% if @tags.present? %>
              <%= link_to "Clear filters", rolls_path(tab: @tab, query: params[:query]),
                  class: "text-error hover:text-error/70 font-handwriting text-base underline transition-colors ml-2 w-full text-center mt-2 block",
                  data: { turbo_stream: true, turbo_action: "advance" } %>
            <% end %>
          </div>
        </div>
      </details>
    </div>
  </div>
<% end %>
