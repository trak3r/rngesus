<% content_for :title, @randomizer.name %>

<div class="max-w-4xl mx-auto py-8 px-4">
  <div class="flex items-center justify-between mb-8 pb-4 border-b-4 border-black">
    <div class="flex items-center gap-3">
      <h1 class="text-3xl font-bold font-header">
        <%= @randomizer.name %>
      </h1>
      <% if @randomizer.primary_tag %>
        <%= link_to @randomizer.primary_tag.name,
            randomizers_path(tag: @randomizer.primary_tag.name),
            class: "px-3 py-1 border-2 border-gray-300 bg-white text-gray-600 hover:border-black hover:text-black transition-all text-sm font-semibold" %>
      <% end %>
    </div>

    <%= render "like_button", randomizer: @randomizer, position_classes: "" %>
  </div>

  <% if notice.present? %>
    <p class="py-2 px-3 bg-green-50 mb-5 text-green-700 font-medium rounded-lg inline-block" id="notice"><%= notice %></p>
  <% end %>

  <%= render @randomizer %>

  <div class="mt-8">
    <h2 class="text-2xl font-bold font-header mb-4 border-b-2 border-black pb-2">Rolls</h2>
    
    <div class="card-clean p-0 overflow-hidden">
      <% if @randomizer.rolls.any? %>
        <table class="w-full">
          <thead>
            <tr class="bg-black text-white">
              <th class="text-left py-2 px-4 font-semibold">Name</th>
              <th class="text-left py-2 px-4 font-semibold">Dice</th>
              <th class="text-right py-2 px-4 font-semibold w-32">Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @randomizer.rolls.each do |roll| %>
              <tr class="border-b border-gray-200 hover:bg-gray-50 transition-colors last:border-0">
                <td class="py-3 px-4 font-medium"><%= link_to roll.name, roll_path(roll), class: "hover:text-dnd-red transition-colors" %></td>
                <td class="py-3 px-4 font-mono text-sm text-gray-600"><%= roll.dice_object.name %></td>
                <td class="py-3 px-4 text-right">
                  <div class="flex justify-end items-center gap-3">
                    <%= link_to edit_roll_path(roll), class: "text-gray-400 hover:text-black transition-colors p-1" do %>
                      <%= icon(:edit, class: "w-4 h-4") %>
                    <% end %>
                    <%= button_to roll_path(roll), method: :delete, data: { turbo_confirm: "Are you sure?" }, class: "text-gray-400 hover:text-dnd-red transition-colors p-1" do %>
                      <%= icon(:trash, class: "w-4 h-4") %>
                    <% end %>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <div class="p-8 text-center text-gray-500">
          No rolls yet. Click "New Roll" to get started.
        </div>
      <% end %>
    </div>
  </div>

  <div class="mt-8 flex items-center gap-4">
    <%= link_to "New Roll", new_randomizer_roll_path(@randomizer), class: "btn-primary-dnd" %>
    <%= link_to "Edit", edit_randomizer_path(@randomizer), class: "btn-clean" %>
    <%= button_to "Delete", @randomizer, method: :delete, class: "text-gray-400 hover:text-dnd-red transition-colors font-semibold ml-auto", data: { turbo_confirm: "Are you sure?" } %>
  </div>
</div>
