<%= form_with(model: randomizer, class: "contents") do |form| %>
  <% if randomizer.errors.any? %>
    <div id="error_explanation" class="alert alert-error">
      <div>
        <h2><%= pluralize(randomizer.errors.count, "error") %> prohibited this randomizer from being saved:</h2>

        <ul class="list-disc ml-6 mt-2">
          <% randomizer.errors.each do |error| %>
            <li><%= error.full_message %></li>
          <% end %>
        </ul>
      </div>
    </div>
  <% end %>

  <div class="my-5">
    <%= form.label :name, class: "label" %>
    <%= form.text_field :name,
                    class: [
                      "input-handwritten w-full",
                      {
                        "border-red-500": randomizer.errors[:name].any?,
                      },
                    ] %>
  </div>

  <div class="my-5">
    <%= form.label :tag_ids, "Tags (optional, max 3)", class: "label font-typewriter text-pencil" %>
    <%= hidden_field_tag 'randomizer[tag_ids][]', '' %>
    <div class="flex flex-wrap gap-3 p-4 border-2 border-dashed border-pencil/30 rounded-lg bg-base-100">
      <% Tag.order(:name).each do |tag| %>
        <label class="flex items-center gap-2 cursor-pointer hover:bg-base-200 p-2 rounded transition-colors">
          <%= check_box_tag 'randomizer[tag_ids][]', tag.id, randomizer.tag_ids.include?(tag.id), 
                            class: "checkbox checkbox-sm",
                            id: "randomizer_tag_ids_#{tag.id}" %>
          <span class="font-handwriting text-base"><%= tag.name %></span>
        </label>
      <% end %>
    </div>
    <p class="text-sm text-pencil/60 mt-1 font-handwriting">Select up to 3 game systems for this randomizer</p>
  </div>

  <div class="inline">
    <%= form.submit "Submit", class: "btn-doodle cursor-pointer" %>
  </div>
<% end %>
